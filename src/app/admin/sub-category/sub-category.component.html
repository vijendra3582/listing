<div class="buttons">
    <span class="heading-uppper-table">Manage Sub Category</span>
    <a href="javascript:void(0)" (click)="add()" *ngIf="sessionRole != 'vendor'">New Sub Category</a>
</div>
<div class="nz-table">
    <nz-table #ajaxTable nzShowSizeChanger [nzFrontPagination]="false" [nzData]="listOfData" [nzLoading]="loading"
        [nzTotal]="total" [(nzPageIndex)]="pageIndex" [(nzPageSize)]="pageSize" (nzPageIndexChange)="searchData()"
        (nzPageSizeChange)="searchData(true)">
        <thead (nzSortChange)="sort($event)" nzSingleSort>
            <tr>
                <th nzLeft="0px" nzShowSort nzSortKey="id">Sub Category ID</th>
                <th nzShowSort nzSortKey="name">Name</th>
                <th>Parent Category</th>
                <th>Slug</th>
                <th>Status</th>
                <th nzRight="0px" *ngIf="sessionRole != 'vendor'">Action</th>
            </tr>
            <tr>
                <td class="p-td-search">
                    <input type="text" (keyup.enter)="searchData(true)" [(ngModel)]="search.id" class="td-search">
                </td>
                <td class="p-td-search">
                    <input type="text" (keyup.enter)="searchData(true)" [(ngModel)]="search.name" class="td-search">
                </td>
                <td class="p-td-search">
                    <input type="text" (keyup.enter)="searchData(true)" [(ngModel)]="search.category" class="td-search">
                </td>
                <td class="p-td-search">
                    <input type="text" (keyup.enter)="searchData(true)" [(ngModel)]="search.slug" class="td-search">
                </td>
                <td class="p-td-search">
                    <input type="text" (keyup.enter)="searchData(true)" [(ngModel)]="search.status" class="td-search">
                </td>
                <td class="p-td-search disabled" *ngIf="sessionRole != 'vendor'">

                </td>
            </tr>
        </thead>
        <tbody>
            <tr *ngFor="let data of ajaxTable.data; index as i">
                <td nzLeft="0px">{{ data.id }}</td>
                <td>{{ data.name }}</td>
                <td>{{ data.main_category_name }}</td>
                <td>{{ data.slug }}</td>
                <td class="capitalize">{{ data.status }}</td>
                <td nzRight="0px" *ngIf="sessionRole != 'vendor'">
                    <ul>
                        <li class="gray">
                            <a (click)="edit(data.id)" class="edit">Edit</a>
                        </li>
                        <li class="tomato">
                            <a nz-popconfirm nzPopconfirmTitle="Are you sure delete this sub category ?"
                                (nzOnConfirm)="delete(data.id)" nzPopconfirmPlacement="topRight" class="delete"
                                href="#">Delete</a>
                        </li>
                    </ul>
                </td>
            </tr>
        </tbody>
    </nz-table>
</div>
<nz-modal [(nzVisible)]="SubCategoryAddEditModal" nzTitle="{{ SubCategoryAddEditModalTitle }}" (nzOnCancel)="cancel()"
    [nzFooter]="modalFooter" [nzNoAnimation]="true" [nzMaskClosable]="false">
    <form nz-form [formGroup]="categoryForm">
        <nz-form-item>
            <nz-form-label nzRequired nzFor="main_category">Category</nz-form-label>
            <nz-form-control>
                <nz-select nzShowSearch nzAllowClear nzPlaceHolder="Select category" formControlName="category_id"
                    [(ngModel)]="subCategory.category_id">
                    <nz-option *ngFor="let category of mainCategory" nzLabel="{{ category.name }}"
                        nzValue="{{ category.id }}"></nz-option>
                </nz-select>
            </nz-form-control>
            <app-field-error [submitted]="submitted" [server_message]="server_message.category_id"
                [control]="categoryForm.get('category_id')"></app-field-error>
        </nz-form-item>
        <nz-form-item>
            <nz-form-label nzRequired nzFor="name">Name</nz-form-label>
            <nz-form-control>
                <input nz-input id="name" formControlName="name" [(ngModel)]="subCategory.name" />
            </nz-form-control>
            <app-field-error [submitted]="submitted" [server_message]="server_message.name"
                [control]="categoryForm.get('name')"></app-field-error>
        </nz-form-item>
        <nz-form-item>
            <nz-form-label nzRequired nzFor="slug">Slug</nz-form-label>
            <nz-form-control>
                <input nz-input id="slug" formControlName="slug" [(ngModel)]="subCategory.slug"
                    (focus)="convertToSlug()" />
            </nz-form-control>
            <app-field-error [submitted]="submitted" [server_message]="server_message.slug"
                [control]="categoryForm.get('slug')"></app-field-error>
        </nz-form-item>
        <nz-form-item>
            <nz-form-label nzRequired nzFor="status">Status</nz-form-label>
            <nz-form-control>
                <nz-radio-group [(ngModel)]="subCategory.status" formControlName="status">
                    <label nz-radio nzValue="active">Active</label>
                    <label nz-radio nzValue="inactive">Inactive</label>
                </nz-radio-group>
            </nz-form-control>
            <app-field-error [submitted]="submitted" [server_message]="server_message.status"
                [control]="categoryForm.get('status')"></app-field-error>
        </nz-form-item>
        <ng-template #modalFooter>
            <button nz-button nzType="default" (click)="cancel()">Cancel</button>
            <button nz-button nzType="primary" (click)="submit()"
                [nzLoading]="isSubmitLoading">{{ SubCategoryAddEditModalButton }}</button>
        </ng-template>
    </form>
</nz-modal>